\documentclass[8pt]{extarticle}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\usepackage[a4paper,left=2.3cm,right=1.2cm,top=2cm,bottom=2cm]{geometry} 
\usepackage{blindtext}
\usepackage{setspace}
\usepackage{float}
\usepackage{titletoc}
\usepackage{titlesec}
\usepackage{wrapfig}
\usepackage{tikz}
\usepackage{amsmath} 
\usepackage{multicol}
\usepackage{amsfonts} 
\usepackage{comment}
\usepackage{booktabs}
\usepackage{bbm}
\usepackage{wrapfig}
\usepackage{verbatimbox}
\usepackage{enumitem}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{bigints}
\onehalfspacing
\usepackage[hidelinks]{hyperref}
\usepackage[all]{nowidow} %funktioniert nicht....
\clubpenalty=9996
\widowpenalty=9999
\brokenpenalty=4991
\predisplaypenalty=10000
\postdisplaypenalty=1549
\displaywidowpenalty=1602
\usepackage[round]{natbib} 
\usepackage{enumitem}

\usepackage{titlesec}
\newcommand{\sectionbreak}{\clearpage}

\allowdisplaybreaks

\setlength\parindent{0pt}

\newcommand{\zerodisplayskips}{%
  \setlength{\abovedisplayskip}{2pt}%
  \setlength{\belowdisplayskip}{2pt}%
  \setlength{\abovedisplayshortskip}{2pt}%
  \setlength{\belowdisplayshortskip}{2pt}}
\appto{\normalsize}{\zerodisplayskips}
\appto{\small}{\zerodisplayskips}
\appto{\footnotesize}{\zerodisplayskips}

\newcommand\independent{\protect\mathpalette{\protect\independenT}{\perp}}
\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern2mu{#1#2}}}



%Hier sind die unterschiedlichen Ausführlichkeitsgrade definiert
\includecomment{Extensiv} 
\includecomment{Proof} 
\includecomment{Annahmen}
\includecomment{Mathspez}
\includecomment{Mathfolg}
\includecomment{Rechreg}
\mdfdefinestyle{MyFrame}{%
    linecolor=black!20!,
    outerlinewidth=0.2pt,
    roundcorner=5pt,
    innertopmargin=0.5\baselineskip,
    innerbottommargin=0.5\baselineskip,
    innerrightmargin=10pt,
    innerleftmargin=10pt,
    backgroundcolor=white}
\specialcomment{Proof}{\begin{mdframed}[style=MyFrame,nobreak=true] Proof: \ \\}{\end{mdframed}}
\specialcomment{Rechreg}{\noindent \textit{Calculation Rules:} \begin{itemize}[nosep,label=$\star$] }{\end{itemize}}
\renewcommand\ThisComment[1]{% Fix for Umlauts in comments
  \immediate\write\CommentStream{\unexpanded{#1}}%
}

% Hier die Ausführlichkeit bestimmen:
%\excludecomment{Extensiv} 
%\excludecomment{Proof} 
%\excludecomment{Annahmen}
%\excludecomment{Mathspez}
%\excludecomment{Mathfolg}

% Inhaltsverzeichnis mit zwei Spalten
\usepackage[toc]{multitoc}
\renewcommand*{\multicolumntoc}{2}




%Überschriftengrößen anpassen, so dass Paragraph kleiner ist als Subsubsection
\titleformat{\section}
  {\normalfont\fontsize{16}{15}\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
  {\normalfont\fontsize{14}{15}\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
  {\normalfont\fontsize{12}{15}\bfseries}{\thesubsubsection}{1em}{}


\begin{document}

\topskip0pt
\vspace*{18em}

\hrule
\begin{center}
{\fontsize{30}{60}\selectfont \textbf{Causal Inference}} \\ \

{\fontsize{20}{60}\selectfont a summary}
\end{center}
\hrule

\tableofcontents




% weitere Anpassungen im Hauptteil des Dokuments
\raggedright %linksbündig
\setlength{\parindent}{15pt} %Einzuglänge festsetzen
\setlength{\columnseprule}{0.3pt} %Liniendicke zwischen zwei Multicols






%-------------------------------------------------------------------------------

% SECTION: GENERAL

%-------------------------------------------------------------------------------

\section{General}

\begin{multicols}{2}

\paragraph{\large Causal Roadmap} \citep{petersen2014causal} 
systematic approach linking causality to statistical procedures

\noindent \textbf{1. Specifying Knowledge.} structural causal model (unifying counterfactual language, structural equations, \& causal graphs): a set of possible data-generating processes, expresses background knowledge and its limits

\noindent \textbf{2. Linking Data.} specifying measured variables and sampling specifics (latter can be incorporated into the model)

\noindent \textbf{3. Specifying Target.} define hypothetical experiment: decide
\noindent\begin{enumerate}[itemsep=0em, topsep=0pt, partopsep=0pt,parsep=0pt]
\setlength{\itemsep}{0pt}%
\setlength{\parskip}{0pt}
\item variables to intervene on: one (point treatment), multiple (longitudinal, censoring/missing, (in)direct effects)
\item intervention scheme: static, dynamic, stochastic
\item counterfactual summary of interest: absolute or relative, marginal structural models, interaction, effect modification
\item population of interest: whole, subset, different population
\end{enumerate}

\noindent \textbf{4. Assessing Identifiability.} are knowledge and data sufficient to derive estimand and if not, what else is needed?

\noindent \textbf{5. Select Estimand.} current best answer: knowledge-based assumptions $+$ which minimal convenience-based asspumptions (transparency) gets as close as possible

\noindent \textbf{6. Estimate.} choose estimator by statistical properties, nothing causal here

\noindent \textbf{7. Interpret.} hierarchy: statistical, counterfactual, feasible intervention, randomized trial



\paragraph{Notation} chapter 1.1

\paragraph{average causal effect} chapter 1.2 and 1.3 and 1.4 and 1.5

\paragraph{randomized experiments (target trial)} 2.1 and 2.2; 3.6

\paragraph{\large Standardization} adjust for (surrogate) confounders $L$
$$\mathrm{E}\left[Y|A=a\right] = \int \mathrm{E}\left[Y|L=l, A=a\right]dF_L\left[l\right]$$
weighted average of stratum-specific risks; unknowns can be estimated non-parametrically or modeled

\noindent \textbf{no need to estimate $\boldsymbol{f_L\left[l\right]}$} as empirical distribution can be used: estimate outcome model $\rightarrow$ predict counterfactuals $\rightarrow$ average the results ($\rightarrow$ CI by bootstrapping)

\noindent \textbf{for discrete $\boldsymbol{ L}$}  $\mathrm{E}\left[Y|A=a\right] = \sum_l \mathrm{E}\left[Y|L=l, A=a\right]\mathrm{Pr}\left[L=l\right]$

\paragraph{\large IP Weighting} adjust for (surrogate) confounders $L$
$$\mathrm{E}\left[Y|A=a\right] = \mathrm{E}\left[\frac{I(A=a)Y}{f\left[A|L\right]}\right]; W^A=\frac{1}{f\left[A|L\right]}; SW^A = \frac{f(A)}{f\left[A|L\right]}$$

\noindent unknowns can be estimated non-parametrically or modeled
\noindent \textbf{pseudo-population:} everyone is treated \& untreated ($L\not\to A$)

\noindent \textbf{FRCISTG} \textit{(fully randomized causally interpreted structured graph)}: probability tree for $L \rightarrow A \rightarrow Y$, can be used to calculate/visualize simulation of values for $A$ 

\noindent \textbf{for discrete $\boldsymbol{A, L}$} $f\left[a|l\right] = \mathrm{Pr}\left[A=a,L=l\right]$

\noindent \textbf{estimators:} Horvitz-Thompson; Hajek (modified version) %todo p.152 

\noindent \textbf{stabilized weights $\boldsymbol{SW^A}$} should have an average of 1 (check!) $\rightarrow$ pseudo-population same size $\rightarrow$ CI width $\downarrow$

\paragraph{\large Standardization and IP Weighting}

are equivalent, \textit{\textbf{but}} if modeled, different ``no misspecification'' assumptions:

standardization: outcome model

IP weighting: treatment model

\noindent \textbf{doubly robust estimators:} reduce model misspecification bias, consistent if either model is correct; \textbf{\textit{e.\,g.:}} \vspace{-0.9em}

1. fit outcome regression with variable $R = \begin{cases} +W^A & \text{if } A{=}1 \\ -W^A & \text{if } A{=}0 \end{cases}$ \vspace{-0.9em}

2. calculate counterfactual results




\paragraph{identifiability conditions} most of 3

positivity: p. 155, p. 162

additional conditions: chapter 13.5

exchangeability: p 172f

\paragraph{effect modification} chapter 4

\paragraph{interaction} chapter 5

\paragraph{causal diagrams} chapter 6, include swigs from 7.5 and that one technical point

\paragraph{confounding} chapter 7

\paragraph{selection bias} chapter 8

\paragraph{measurement bias} chapter 9

\paragraph{random variabilty} chapter 10



\end{multicols}



%-------------------------------------------------------------------------------

% SECTION: MODELS

%-------------------------------------------------------------------------------

\section{Models}
\begin{multicols}{2}

\paragraph{\large Modeling} data are a sample from the target population \vspace{0.4em}

\noindent \hspace{0.9em}\begin{tabular}{l l l}
\textbf{\it estimand:} & quantity  of interest, & e.\,g. $\mathrm{E}\left[Y|A=a\right]$ \\
\textbf{\it estimator:} & function to use, & e.\,g. $\widehat{\mathrm{E}}\left[Y|A=a\right]$ \\
\textbf{\it estimate:} & apply function to data, & e.\,g. $4.1$ 
\end{tabular} \vspace{0.5em}

\noindent \textbf{model}: a priori restriction of joint distribution/dose-response curve;  \textit{assumption:} no model misspecification (usually wrong)

\noindent \textbf{non-parametric estimator:} no restriction (saturated model) $=$ \textit{Fisher consistent estimator} (entire population data $\rightarrow$ true value)

\noindent \textbf{parsimonious model:} few parameters estimate many quantities

\noindent \textbf{bias-variance trade-off:} \newline wiggliness $\uparrow$ $\rightarrow$ misspecification bias $\downarrow$, CI width $\uparrow$


\paragraph{\large Marginal Structural Models} association is causation in the IP weighted pseudo-population 
$$\text{associational model } \mathrm{E}\left[Y|A\right] = \text{ causal model } \mathrm{E}\left[Y^a\right]$$

\noindent \textit{step 1:} estimate/model $f\left[A|L\right]$ (and $f\left[A\right]$) $\rightarrow$ get $(S)W^A$

\noindent \textit{step 2:} estimate regression parameters for pseudo-population

\noindent \textbf{effect modification} variables $V$ can be included (e.\,g. $\beta_0+\beta_1 a+\beta_2 V a + \beta_3 V$; technically not marginal anymore), $SW^A(V) = \frac{f\left[A|V\right]}{f\left[A|L\right]}$ more efficient than $SW^A$
 

\paragraph{\large Censoring} measuring joint effect of $A$ and $C$
$$\mathrm{E}\left[Y^{a, c=0}\right] \text{ is of interest}$$

\noindent \textbf{standardization} $\mathrm{E}\left[Y|A=a\right] = \int \mathrm{E}\left[Y|L{=}l, A{=}a, C{=}0\right]dF_L\left[l\right]$\vspace{0.2em}

\noindent \textbf{IP weights}\vspace{-1.30em}

\hspace{3.5em}\begin{tabular}{l l l}
$W^{A,C}=W^A \times W^C$  &(uses $n$) & or \\
$SW^{A,C}=SW^A \times SW^C$ &(uses $n^{c=0}$) & 
\end{tabular}\vspace{0.3em}



\paragraph{\large G-Methods} \textit{g}eneralized treatment contrasts
adjust for (surrogate) confounders $L$
\begin{itemize}[itemsep=0em, topsep=0pt, partopsep=0pt,parsep=0pt]
\setlength{\itemsep}{0pt}%
\setlength{\parskip}{0pt}
\item \textbf{standardization}
\item \textbf{IP weighting}
\item \textbf{g-estimation:} not needed unless longitudinal
\end{itemize}


\paragraph{\large G-Estimation} additive structural nested models
$$\mathrm{logit} \, \mathrm{Pr}\left[A=1|Y^{a=0}, L\right] = \alpha_0 + \alpha_1Y^{a=0} + \alpha_2L$$
because of exchangeability $\alpha_1$ should be zero
$$Y^{a=0} =Y^a - \psi_1 a$$
holds because ...







e.g. average causal effect in certain strata E(Y1|L) - E(Y0|L) 

model P(A|Y(a=0), L) = a0 + a1Y(a=0) + a2L, if exchangability holds a1=0 [Y(a=0) unknown]

model is only nested when treatment is time-varying, if no time-varying, snm equal to semiparametric marginal structural models (fp 14.1)


E(Y1|L) - E(Y0|L) = E(Y1 - Y0|L) therefore  P(Ya -Y(a=0)| A=a, L) = a1a  + a2aL

semi-parametric as they are agnostic about a0 and effect of L alone, therefore fewer assumptions, more robust

g-estimation can only handle confounding, not selection bias, therefore IP weights for censoring


multiplicative structural nested model (tp 14.1)

rank preservation (implausible): ranking Y in both counterfactual worlds gives same order (effect is basically the same for all; either additive or multiplicative)

additive conditional rp: Yai -Y0i = w1a + w2aLi for all individuals i

g-estimation is easier to understand for rank-preserving models


suppose goal: E(Ya -Y(a=0)| A=a, L) = b1 a

assume rank-preserving Yai -Y0i = w1a  is correct

Y0 = Ya -w1a (rewritten)

Y0 = Y - w1A = H

put in formula from above

P(A|Y(a=0), L) = a0 + a1 H + a2L 

find which w1 makes a1 be zero

95\% CI: all w1 for which w1=0? had result of greater than 0.05

we do not require rank preservation

if there is unmeasured confounding (a1 not zero) we can use the correct a1 and still use g-estimation. If we are not sure about a1, we can try some values (sensitivity analysis)

effect modification can be added into formula

for linear mean models: closed form, otherwise search

doubly robust estimators exist







\paragraph{Outcome regression} chapter 15

\paragraph{instrumental variable estimation} chapter 16

\paragraph{causal survival analysis} chapter 17

\paragraph{variable selection} beginning of chapter 18


\paragraph{machine learning in CI} end of chapter 18







\end{multicols}

%-------------------------------------------------------------------------------

% SECTION: LONGITUDINAL

%-------------------------------------------------------------------------------

\section{Longitudinal Data}
\begin{multicols}{2}

\paragraph{time-varying treatments} beginning chapter 19

\paragraph{identifiability} middle chapter 19

\paragraph{treatment-confounder feedback} end chapter 19 and chapter 20

\paragraph{g-formula} chapter 21.1

\paragraph{IP weighting} chapter 21.2

\paragraph{doubly robust estimators} chapter 21.3

\paragraph{g-estimation} chapter 21.4

\paragraph{censoring} chapter 21.5

\paragraph{target trial} chapter 22 (does that even really fit in here, maybe push to 3rd paragraph in without models)



\end{multicols}


\def\bibpreamble{\textit{If no citation is given, the source is \citep{hernan2023causal}} \vspace{1.5em}}

\bibliographystyle{apalike} % We choose the "plain" reference style
\bibliography{cite} % Entries are in the refs.bib file



\end{document}